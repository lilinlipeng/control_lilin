{"version":3,"file":"HealthArticleForm.js","sources":["pages/Front/HealthArticleForm.vue","../../HBuilderX/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvRnJvbnQvSGVhbHRoQXJ0aWNsZUZvcm0udnVl"],"sourcesContent":["<template>\n    <view>\n        <uni-nav-bar dark :fixed=\"true\" shadow background-color=\"var(--primary-color)\" status-bar left-icon=\"left\"\n            left-text=\"返回\" @clickLeft=\"goBack\" title=\"健康知识信息\" />\n\n        <uni-section title=\"请填写健康知识信息\">\n            <view class=\"form-container\">\n\n                <uni-forms ref=\"editModalForm\" :model=\"formData\" :rules=\"editModalFormRules\" label-width='100'\n                    label-position='top'>\n                    <uni-forms-item label=\"标题\" required name=\"Title\">\n                        <uni-easyinput v-model=\"formData.Title\" placeholder=\"请输入标题\" primaryColor=\"var(--primary-color)\" />\n                    </uni-forms-item>\n                    <uni-forms-item label=\"分类\" required name=\"HealthArticleTypeId\">\n                        <sigle-select url=\"/HealthArticleType/List\" columnName=\"Name\" columnValue=\"Id\"\n                            v-model=\"formData.HealthArticleTypeId\">\n                        </sigle-select>\n                    </uni-forms-item>\n\n\n                    <uni-forms-item label=\"封面\" required name=\"Cover\">\n                        <upload-images v-model=\"formData.Cover\">\n                        </upload-images>\n                    </uni-forms-item>\n\n                    <uni-forms-item label=\"内容\" name=\"Content\">\n                        <rich-text-edit  ref=\"ContentRichTextEditRef\" v-model=\"formData.Content\"></rich-text-edit>\n                    </uni-forms-item>\n                </uni-forms>\n                <button class=\"btn-primary\" @click=\"createOrEditAsync\">提交</button>\n            </view>\n\n        </uni-section>\n\n\n    </view>\n</template>\n\n<script setup>\n\nimport { useCommonStore } from '@/store';\nimport { Post } from \"@/utils/http\";\nimport { onLoad, onReady, onShow } from \"@dcloudio/uni-app\";\nimport { computed, nextTick, reactive, ref } from 'vue';\n\n// 获取store\nconst commonStore = useCommonStore();\nconst Token = computed(() => commonStore.Token)\nconst UserInfo = computed(() => commonStore.UserInfo)\nconst RoleType = computed(() => commonStore.RoleType)\nconst UserId = computed(() => commonStore.UserId)\n\n\n// 表单数据和规则\nconst formData = reactive({\n});\nconst editModalForm = ref(null);\n\nconst Id = ref(null);\nconst editModalFormRules = {\n    Title: {\n        rules: [\n            {\n                required: true,\n                errorMessage: '该项为必填项'\n            },\n\n        ]\n    },\n    HealthArticleTypeId: {\n        rules: [\n            {\n                required: true,\n                errorMessage: '该项为必填项'\n            },\n\n        ]\n    },\n    PublishUserId: {\n        rules: [\n            {\n                required: true,\n                errorMessage: '该项为必填项'\n            },\n\n        ]\n    },\n    AuditUserId: {\n        rules: [\n            {\n                required: true,\n                errorMessage: '该项为必填项'\n            },\n\n        ]\n    },\n    AuditStatus: {\n        rules: [\n            {\n                required: true,\n                errorMessage: '该项为必填项'\n            },\n\n        ]\n    },\n    Cover: {\n        rules: [\n            {\n                required: true,\n                errorMessage: '该项为必填项'\n            },\n\n        ]\n    },\n    ViewCount: {\n        rules: [\n            {\n                required: true,\n                errorMessage: '该项为必填项'\n            },\n\n        ]\n    },\n    AuditTime: {\n        rules: [\n            {\n                required: true,\n                errorMessage: '该项为必填项'\n            },\n\n        ]\n    },\n\n};\n\nconst ContentRichTextEditRef = ref(null);\n\n\n// 生命周期钩子\nonLoad(async (option) => {\n    Id.value = option.Id;\n    ShowEditModal(Id.value);\n\n\n});\n\nonShow(async () => {\n    // 页面显示时的逻辑\n});\n\nonReady(async () => {\n\n\n});\n\n// 显示编辑对话框\nconst ShowEditModal = async (Id) => {\n\n    const { Data } = await Post(`/HealthArticle/Get`, { Id: Id });\n    if (!Id) {\n        Data.PublishUserId = UserId.value;\n        Data.AuditStatus = 1;\n    }\n    Object.assign(formData, Data);\n\n\n\n    if (ContentRichTextEditRef.value) {\n        ContentRichTextEditRef.value.setContent(Data.Content);\n    }\n\n    nextTick(() => {\n        // 设置自定义表单校验规则，必须在节点渲染完毕后执行\n        editModalForm.value.setRules(editModalFormRules);\n    });\n};\n\n// 方法\nconst goBack = () => {\n    uni.navigateBack();\n};\n\n//地址选择回调\nconst AddressSelected = (data) => {\n    formData.Address = data.fullAddress;\n\n};\n\n// 创建或修改方法\nconst createOrEditAsync = async () => {\n    editModalForm.value.validate().then(res => {\n        uni.showModal({\n            title: \"提示\",\n            content: \"你确定要操作吗?\",\n            showCancel: true,\n            cancelText: \"取消\",\n            confirmText: \"确定\",\n            success: async (res) => {\n                if (res.confirm) {\n                    formData.Content = await ContentRichTextEditRef.value.getContent();\n                    if (!formData.Content) {\n                        uni.showToast({\n                            title: \"请输入内容\",\n                            icon: \"none\"\n                        });\n                        return;\n                    }\n                    let { Data, Success } = await Post(\"/HealthArticle/CreateOrEdit\", formData);\n                    if (Success) {\n                        uni.showToast({\n                            title: \"操作成功\",\n                            icon: \"success\"\n                        });\n\n                        uni.navigateBack();\n                    }\n                }\n            }\n        });\n\n    }).catch(err => {\n        uni.showToast({\n            title: \"请检测输入项是否正确\",\n            icon: \"none\"\n        });\n\n    });\n\n\n};\n</script>\n\n<style scoped lang=\"scss\"></style>","import MiniProgramPage from 'F:/workspace/HealthControl.uniapp/pages/Front/HealthArticleForm.vue'\nwx.createPage(MiniProgramPage)"],"names":["useCommonStore","computed","reactive","ref","onLoad","onShow","onReady","Id","Post","nextTick","uni","res","MiniProgramPage"],"mappings":"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"}