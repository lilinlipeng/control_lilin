{"version":3,"file":"CollectRecordList.js","sources":["pages/Front/CollectRecordList.vue","../../HBuilderX/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvRnJvbnQvQ29sbGVjdFJlY29yZExpc3QudnVl"],"sourcesContent":["<template>\n    <view>\n        <!-- 导航栏 -->\n        <uni-nav-bar dark :fixed=\"true\" shadow background-color=\"var(--primary-color)\" status-bar left-icon=\"left\"\n            left-text=\"返回\" @clickLeft=\"goBack\" title=\"收藏记录列表\" />\n\n        <!-- Tab切换 -->\n        <view class=\"tab-container\">\n            <view class=\"tab-item\" :class=\"{ active: activeTab === '健康知识' }\" @click=\"switchTab('健康知识')\">\n                健康知识\n            </view>\n            <view class=\"tab-item\" :class=\"{ active: activeTab === '食谱' }\" @click=\"switchTab('食谱')\">\n                食谱\n            </view>\n        </view>\n\n        <!-- 列表内容 -->\n        <view class=\"list-container\">\n            <!-- 健康知识列表 -->\n            <view v-if=\"activeTab === '健康知识'\" class=\"content-list\">\n                <view v-if=\"healthArticleList.length === 0\" class=\"empty-state\">\n                    暂无健康知识收藏\n                </view>\n                <view v-else>\n                    <view v-for=\"item in healthArticleList\" :key=\"item.Id\" class=\"list-item\" @click=\"goToDetail(item)\">\n                        <!-- 封面图片 -->\n                        <image :src=\"item.HealthArticleDto.Cover\" class=\"item-cover\" mode=\"aspectFill\"></image>\n\n                        <!-- 内容信息 -->\n                        <view class=\"item-content\">\n                            <view class=\"item-title\">{{ item.HealthArticleDto.Title }}</view>\n                            <view class=\"item-meta\">\n                                <text class=\"view-count\">阅读 {{ item.HealthArticleDto.ViewCount }}</text>\n                                <text class=\"collect-time\">{{ formatTime(item.CreationTime) }}</text>\n                            </view>\n                        </view>\n\n                        <!-- 操作按钮 -->\n                        <view class=\"item-actions\">\n                            <view class=\"delete-btn\" @click.stop=\"ShowDeleteModal(item.Id)\">删除</view>\n                        </view>\n                    </view>\n                </view>\n            </view>\n\n            <!-- 食谱列表 -->\n            <view v-if=\"activeTab === '食谱'\" class=\"content-list\">\n                <view v-if=\"recipeList.length === 0\" class=\"empty-state\">\n                    暂无食谱收藏\n                </view>\n                <view v-else>\n                    <view v-for=\"item in recipeList\" :key=\"item.Id\" class=\"list-item\" @click=\"goToDetail(item)\">\n                        <!-- 封面图片 -->\n                        <image :src=\"item.RecipeDto.Cover\" class=\"item-cover\" mode=\"aspectFill\"></image>\n\n                        <!-- 内容信息 -->\n                        <view class=\"item-content\">\n                            <view class=\"item-title\">{{ item.RecipeDto.Title }}</view>\n                            <view class=\"item-meta\">\n                                <text class=\"view-count\">浏览 {{ item.RecipeDto.ViewCount }}</text>\n                                <text class=\"collect-time\">{{ formatTime(item.CreationTime) }}</text>\n                            </view>\n                        </view>\n\n                        <!-- 操作按钮 -->\n                        <view class=\"item-actions\">\n                            <view class=\"delete-btn\" @click.stop=\"ShowDeleteModal(item.Id)\">删除</view>\n                        </view>\n                    </view>\n                </view>\n            </view>\n        </view>\n\n    </view>\n</template>\n\n<script setup>\n\nimport { useCommonStore } from '@/store';\nimport { Post } from '@/utils/http';\nimport { onLoad, onReady, onShow } from \"@dcloudio/uni-app\";\nimport { computed, reactive, ref } from 'vue';\n\n// 获取store\nconst commonStore = useCommonStore();\nconst Token = computed(() => commonStore.Token)\nconst UserInfo = computed(() => commonStore.UserInfo)\nconst RoleType = computed(() => commonStore.RoleType)\nconst UserId = computed(() => commonStore.UserId)\n\n// 数据定义\nconst CollectRecordList = ref([]); // 修复变量定义\nconst activeTab = ref('健康知识'); // 当前激活的tab\n\n// 计算属性：根据tab过滤列表数据\nconst healthArticleList = computed(() => {\n    return CollectRecordList.value.filter(item => item.CollectType === '健康知识');\n});\n\nconst recipeList = computed(() => {\n    return CollectRecordList.value.filter(item => item.CollectType === '食谱');\n});\n\nconst where = reactive({\n\n});\n\n// 生命周期钩子\nonLoad(async (option) => {\n});\nonShow(async () => {\n    GetCollectRecordListApi();\n});\n\nonReady(async () => {\n\n});\n\n// 方法\nconst goBack = () => {\n    uni.navigateBack();\n};\n\n// Tab切换方法\nconst switchTab = (tab) => {\n    activeTab.value = tab;\n};\n\n// 获取收藏记录列表\nconst GetCollectRecordListApi = async () => {\n    let {\n        Data: {\n            Items\n        }\n    } = await Post('/CollectRecord/List', where);\n    CollectRecordList.value = Items;\n}\n\n// 删除收藏记录\nconst ShowDeleteModal = async (Id) => {\n    uni.showModal({\n        title: '提示',\n        content: '确认删除该收藏记录吗？',\n        success: async (res) => {\n            if (res.confirm) {\n                const { Success } = await Post(`/CollectRecord/Delete`, { Id: Id });\n                if (Success) {\n                    await GetCollectRecordListApi();\n                    uni.showToast({\n                        title: '删除成功',\n                        icon: 'success'\n                    });\n                }\n            }\n        }\n    })\n};\n\n// 跳转到详情页\nconst goToDetail = (item) => {\n    if (item.CollectType === '健康知识') {\n        uni.navigateTo({\n            url: `/pages/Front/HealthArticleDetail?HealthArticleId=${item.RelativeId}`\n        });\n    } else if (item.CollectType === '食谱') {\n        uni.navigateTo({\n            url: `/pages/Front/RecipeDetail?RecipeId=${item.RelativeId}`\n        });\n    }\n};\n\n// 时间格式化\nconst formatTime = (timeStr) => {\n    const date = new Date(timeStr);\n    const now = new Date();\n    const diff = now - date;\n\n    // 计算时间差\n    const minutes = Math.floor(diff / (1000 * 60));\n    const hours = Math.floor(diff / (1000 * 60 * 60));\n    const days = Math.floor(diff / (1000 * 60 * 60 * 24));\n\n    if (minutes < 60) {\n        return minutes <= 0 ? '刚刚' : `${minutes}分钟前`;\n    } else if (hours < 24) {\n        return `${hours}小时前`;\n    } else if (days < 7) {\n        return `${days}天前`;\n    } else {\n        return timeStr.split(' ')[0]; // 返回日期部分\n    }\n};\n\n</script>\n\n<style scoped lang=\"scss\">\n/* 页面容器 */\n.tab-container {\n    position: sticky;\n    top: 88rpx;\n    /* 导航栏高度 */\n    z-index: 99;\n    display: flex;\n    background-color: #fff;\n    border-bottom: 1px solid #eee;\n}\n\n/* Tab项样式 */\n.tab-item {\n    flex: 1;\n    text-align: center;\n    padding: 30rpx 0;\n    font-size: 32rpx;\n    color: #666;\n    position: relative;\n    transition: all 0.3s ease;\n}\n\n.tab-item.active {\n    color: var(--primary-color, #007aff);\n    font-weight: 600;\n}\n\n.tab-item.active::after {\n    content: '';\n    position: absolute;\n    bottom: 0;\n    left: 50%;\n    transform: translateX(-50%);\n    width: 60rpx;\n    height: 4rpx;\n    background-color: var(--primary-color, #007aff);\n    border-radius: 2rpx;\n}\n\n/* 列表容器 */\n.list-container {}\n\n/* 内容列表 */\n.content-list {\n    background-color: #fff;\n    border-radius: 12rpx;\n}\n\n/* 空状态 */\n.empty-state {\n    text-align: center;\n    padding: 120rpx 0;\n    color: #999;\n    font-size: 28rpx;\n}\n\n/* 列表项 */\n.list-item {\n    display: flex;\n    align-items: center;\n    padding: 30rpx 20rpx;\n    border-bottom: 1px solid #f5f5f5;\n    background-color: #fff;\n    border-radius: 12rpx;\n    margin-bottom: 20rpx;\n    box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.1);\n    transition: all 0.3s ease;\n}\n\n.list-item:hover {\n    transform: translateY(-2rpx);\n    box-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.15);\n}\n\n.list-item:last-child {\n    border-bottom: none;\n}\n\n/* 封面图片 */\n.item-cover {\n    width: 120rpx;\n    height: 120rpx;\n    border-radius: 12rpx;\n    margin-right: 20rpx;\n    flex-shrink: 0;\n}\n\n/* 内容区域 */\n.item-content {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    height: 120rpx;\n}\n\n/* 标题 */\n.item-title {\n    font-size: 32rpx;\n    font-weight: 600;\n    color: #333;\n    line-height: 1.4;\n    /* 限制两行显示 */\n    display: -webkit-box;\n    -webkit-line-clamp: 2;\n    -webkit-box-orient: vertical;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n/* 元信息 */\n.item-meta {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-top: 10rpx;\n}\n\n.view-count {\n    font-size: 24rpx;\n    color: #999;\n}\n\n.collect-time {\n    font-size: 24rpx;\n    color: #999;\n}\n\n/* 操作按钮 */\n.item-actions {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    margin-left: 20rpx;\n}\n\n.delete-btn {\n    padding: 12rpx 24rpx;\n    background-color: #ff4757;\n    color: #fff;\n    font-size: 24rpx;\n    border-radius: 20rpx;\n    transition: all 0.3s ease;\n}\n\n.delete-btn:hover {\n    background-color: #ff3742;\n    transform: scale(1.05);\n}\n</style>","import MiniProgramPage from 'F:/workspace/HealthControl.uniapp/pages/Front/CollectRecordList.vue'\nwx.createPage(MiniProgramPage)"],"names":["useCommonStore","computed","ref","reactive","onLoad","onShow","onReady","uni","Post"],"mappings":";;;;;;;;;;;;;;;AAoFA,UAAM,cAAcA,YAAc,eAAA;AACpBC,kBAAAA,SAAS,MAAM,YAAY,KAAK;AAC7BA,kBAAAA,SAAS,MAAM,YAAY,QAAQ;AACnCA,kBAAAA,SAAS,MAAM,YAAY,QAAQ;AACrCA,kBAAAA,SAAS,MAAM,YAAY,MAAM;AAGhD,UAAM,oBAAoBC,cAAAA,IAAI,CAAA,CAAE;AAChC,UAAM,YAAYA,cAAAA,IAAI,MAAM;AAG5B,UAAM,oBAAoBD,cAAQ,SAAC,MAAM;AACrC,aAAO,kBAAkB,MAAM,OAAO,UAAQ,KAAK,gBAAgB,MAAM;AAAA,IAC7E,CAAC;AAED,UAAM,aAAaA,cAAQ,SAAC,MAAM;AAC9B,aAAO,kBAAkB,MAAM,OAAO,UAAQ,KAAK,gBAAgB,IAAI;AAAA,IAC3E,CAAC;AAED,UAAM,QAAQE,cAAAA,SAAS,CAEvB,CAAC;AAGDC,kBAAM,OAAC,OAAO,WAAW;AAAA,IACzB,CAAC;AACDC,kBAAAA,OAAO,YAAY;AACf;IACJ,CAAC;AAEDC,kBAAAA,QAAQ,YAAY;AAAA,IAEpB,CAAC;AAGD,UAAM,SAAS,MAAM;AACjBC,oBAAG,MAAC,aAAY;AAAA,IACpB;AAGA,UAAM,YAAY,CAAC,QAAQ;AACvB,gBAAU,QAAQ;AAAA,IACtB;AAGA,UAAM,0BAA0B,YAAY;AACxC,UAAI;AAAA,QACA,MAAM;AAAA,UACF;AAAA,QACH;AAAA,MACJ,IAAG,MAAMC,WAAI,KAAC,uBAAuB,KAAK;AAC3C,wBAAkB,QAAQ;AAAA,IAC9B;AAGA,UAAM,kBAAkB,OAAO,OAAO;AAClCD,oBAAAA,MAAI,UAAU;AAAA,QACV,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,OAAO,QAAQ;AACpB,cAAI,IAAI,SAAS;AACb,kBAAM,EAAE,YAAY,MAAMC,gBAAK,yBAAyB,EAAE,GAAM,CAAE;AAClE,gBAAI,SAAS;AACT,oBAAM,wBAAuB;AAC7BD,4BAAAA,MAAI,UAAU;AAAA,gBACV,OAAO;AAAA,gBACP,MAAM;AAAA,cAC9B,CAAqB;AAAA,YACJ;AAAA,UACJ;AAAA,QACJ;AAAA,MACT,CAAK;AAAA,IACL;AAGA,UAAM,aAAa,CAAC,SAAS;AACzB,UAAI,KAAK,gBAAgB,QAAQ;AAC7BA,sBAAAA,MAAI,WAAW;AAAA,UACX,KAAK,oDAAoD,KAAK,UAAU;AAAA,QACpF,CAAS;AAAA,MACT,WAAe,KAAK,gBAAgB,MAAM;AAClCA,sBAAAA,MAAI,WAAW;AAAA,UACX,KAAK,sCAAsC,KAAK,UAAU;AAAA,QACtE,CAAS;AAAA,MACJ;AAAA,IACL;AAGA,UAAM,aAAa,CAAC,YAAY;AAC5B,YAAM,OAAO,IAAI,KAAK,OAAO;AAC7B,YAAM,MAAM,oBAAI;AAChB,YAAM,OAAO,MAAM;AAGnB,YAAM,UAAU,KAAK,MAAM,QAAQ,MAAO,GAAG;AAC7C,YAAM,QAAQ,KAAK,MAAM,QAAQ,MAAO,KAAK,GAAG;AAChD,YAAM,OAAO,KAAK,MAAM,QAAQ,MAAO,KAAK,KAAK,GAAG;AAEpD,UAAI,UAAU,IAAI;AACd,eAAO,WAAW,IAAI,OAAO,GAAG,OAAO;AAAA,MAC/C,WAAe,QAAQ,IAAI;AACnB,eAAO,GAAG,KAAK;AAAA,MACvB,WAAe,OAAO,GAAG;AACjB,eAAO,GAAG,IAAI;AAAA,MACtB,OAAW;AACH,eAAO,QAAQ,MAAM,GAAG,EAAE,CAAC;AAAA,MAC9B;AAAA,IACL;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9LA,GAAG,WAAW,eAAe;"}