{"version":3,"file":"SportRecordList.js","sources":["pages/Front/SportRecordList.vue","../../HBuilderX/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvRnJvbnQvU3BvcnRSZWNvcmRMaXN0LnZ1ZQ"],"sourcesContent":["<template>\n    <view>\n        <!-- 导航栏 -->\n        <uni-nav-bar dark :fixed=\"true\" shadow background-color=\"var(--primary-color)\" status-bar left-icon=\"left\"\n            left-text=\"返回\" @clickLeft=\"goBack\" title=\"运动记录列表\" />\n\n        <!-- 运动记录列表内容区域 -->\n        <view class=\"content\">\n            <!-- 运动统计卡片 -->\n            <view class=\"statistics-section\">\n                <view class=\"statistics-title\">\n                    <uni-icons type=\"bar-chart\" size=\"20\" color=\"#007aff\"></uni-icons>\n                    <text>运动统计</text>\n                </view>\n                <view class=\"statistics-cards\">\n                    <!-- 总卡路里 -->\n                    <view class=\"stat-card\">\n                        <view class=\"stat-value\">{{ SportRecordSummary.TotalCalories || 0 }}</view>\n                        <view class=\"stat-label\">总消耗卡路里</view>\n                        <view class=\"stat-unit\">卡</view>\n                    </view>\n                    <!-- 本周卡路里 -->\n                    <view class=\"stat-card\">\n                        <view class=\"stat-value\">{{ SportRecordSummary.TotalCaloriesWeek || 0 }}</view>\n                        <view class=\"stat-label\">本周消耗</view>\n                        <view class=\"stat-unit\">卡</view>\n                    </view>\n                    <!-- 本月卡路里 -->\n                    <view class=\"stat-card\">\n                        <view class=\"stat-value\">{{ SportRecordSummary.TotalCaloriesMonth || 0 }}</view>\n                        <view class=\"stat-label\">本月消耗</view>\n                        <view class=\"stat-unit\">卡</view>\n                    </view>\n                </view>\n                <view class=\"statistics-cards\">\n                    <!-- 本周运动次数 -->\n                    <view class=\"stat-card\">\n                        <view class=\"stat-value\">{{ SportRecordSummary.TotalSportCountWeek || 0 }}</view>\n                        <view class=\"stat-label\">本周运动</view>\n                        <view class=\"stat-unit\">次</view>\n                    </view>\n                    <!-- 本月运动次数 -->\n                    <view class=\"stat-card\">\n                        <view class=\"stat-value\">{{ SportRecordSummary.TotalSportCountMonth || 0 }}</view>\n                        <view class=\"stat-label\">本月运动</view>\n                        <view class=\"stat-unit\">次</view>\n                    </view>\n                    <!-- 平均每次消耗 -->\n                    <view class=\"stat-card\">\n                        <view class=\"stat-value\">{{ calculateAvgCalories() }}</view>\n                        <view class=\"stat-label\">平均消耗</view>\n                        <view class=\"stat-unit\">卡/次</view>\n                    </view>\n                </view>\n            </view>\n\n            <!-- 运动记录列表 -->\n            <view v-if=\"SportRecordList.length > 0\" class=\"record-list\">\n                <view v-for=\"record in SportRecordList\" :key=\"record.Id\" class=\"record-item\">\n                    <!-- 运动图标和基本信息 -->\n                    <view class=\"record-header\">\n                        <image :src=\"record.SportDto.Cover\" class=\"sport-icon\" mode=\"aspectFill\"></image>\n                        <view class=\"sport-info\">\n                            <text class=\"sport-name\">{{ record.SportDto.Name }}</text>\n                            <text class=\"record-time\">{{ formatTime(record.RecordTime) }}</text>\n                        </view>\n                        <!-- 删除按钮 -->\n                        <view class=\"delete-btn\" @click=\"ShowDeleteModal(record.Id)\">\n                            <uni-icons type=\"trash\" size=\"20\" color=\"#ff4757\"></uni-icons>\n                        </view>\n                    </view>\n\n                    <!-- 运动数据 -->\n                    <view class=\"record-data\">\n                        <view class=\"data-item\">\n                            <text class=\"data-label\">运动量</text>\n                            <text class=\"data-value\">{{ record.RecordValue }} {{ record.SportUnitDto.UnitName }}</text>\n                        </view>\n                        <view class=\"data-item\">\n                            <text class=\"data-label\">消耗卡路里</text>\n                            <text class=\"data-value calories\">{{ calculateCalories(record.RecordValue,\n                                record.SportUnitDto.Calories) }} 卡</text>\n                        </view>\n                    </view>\n\n                    <!-- 运动描述 -->\n                    <view class=\"sport-description\">\n                        <text>{{ record.SportDto.Content }}</text>\n                    </view>\n                </view>\n            </view>\n\n            <!-- 空状态 -->\n            <view v-else class=\"empty-state\">\n                <uni-icons type=\"list\" size=\"80\" color=\"#c0c4cc\"></uni-icons>\n                <text class=\"empty-text\">暂无运动记录</text>\n                <text class=\"empty-tip\">点击右下角按钮添加运动记录</text>\n            </view>\n        </view>\n\n        <!-- 浮动添加按钮 -->\n        <view class=\"floating-add-btn\" @click=\"goToAddSportRecord\">\n            <uni-icons type=\"plus\" size=\"24\" color=\"#fff\"></uni-icons>\n        </view>\n    </view>\n</template>\n\n<script setup>\n\nimport { useCommonStore } from '@/store';\nimport { Post } from '@/utils/http';\nimport { onLoad, onReady, onShow } from \"@dcloudio/uni-app\";\nimport { computed, reactive, ref } from 'vue';\n\n// 获取store\nconst commonStore = useCommonStore();\nconst Token = computed(() => commonStore.Token)\nconst UserInfo = computed(() => commonStore.UserInfo)\nconst RoleType = computed(() => commonStore.RoleType)\nconst UserId = computed(() => commonStore.UserId)\n\n// 运动记录列表数据\nconst SportRecordList = ref([]);\n\nconst where = reactive({\n    UserId: UserId.value,\n});\n\n// 生命周期钩子\nonLoad(async (option) => {\n});\nonShow(async () => {\n    GetSportRecordListApi();\n    SportRecordSummaryApi();\n});\n\nonReady(async () => {\n\n});\n\n// 方法\nconst goBack = () => {\n    uni.navigateBack();\n};\n\n// 跳转到添加运动记录页面goToAddSportRecord\nconst goToAddSportRecord = () => {\n    uni.navigateTo({\n        url: '/pages/Front/SportList'\n    });\n};\n\n// 获取运动记录列表\nconst GetSportRecordListApi = async () => {\n    let {\n        Data: {\n            Items\n        }\n    } = await Post('/SportRecord/List', where);\n    SportRecordList.value = Items;\n}\nconst SportRecordSummary = ref([]);\nconst SportRecordSummaryApi = async () => {\n    let {\n        Data\n    } = await Post('/SportRecord/SportRecordSummary', where);\n    SportRecordSummary.value = Data;\n}\n\n// 格式化时间显示\nconst formatTime = (timeStr) => {\n    if (!timeStr) return '';\n\n    const date = new Date(timeStr);\n    const now = new Date();\n    const diff = now - date;\n    const minutes = Math.floor(diff / 60000);\n    const hours = Math.floor(diff / 3600000);\n    const days = Math.floor(diff / 86400000);\n\n    // 如果时间解析失败，直接返回原始字符串\n    if (isNaN(date.getTime())) {\n        return timeStr;\n    }\n\n    if (minutes < 1) {\n        return '刚刚';\n    } else if (minutes < 60) {\n        return `${minutes}分钟前`;\n    } else if (hours < 24) {\n        return `${hours}小时前`;\n    } else if (days < 7) {\n        return `${days}天前`;\n    } else {\n        // 显示完整的日期时间格式\n        return date.toLocaleString('zh-CN', {\n            year: 'numeric',\n            month: '2-digit',\n            day: '2-digit',\n            hour: '2-digit',\n            minute: '2-digit',\n            second: '2-digit'\n        });\n    }\n};\n\n// 计算消耗的卡路里\nconst calculateCalories = (recordValue, unitCalories) => {\n    return Math.round(recordValue * unitCalories);\n};\n\n// 计算平均每次消耗\nconst calculateAvgCalories = () => {\n    if (SportRecordSummary.value.TotalSportCountMonth > 0) {\n        return (SportRecordSummary.value.TotalCaloriesMonth / SportRecordSummary.value.TotalSportCountMonth).toFixed(1);\n    }\n    return 0;\n};\n\n// 删除运动记录\nconst ShowDeleteModal = async (Id) => {\n    uni.showModal({\n        title: '提示',\n        content: '确认删除该运动记录吗？',\n        success: async (res) => {\n            if (res.confirm) {\n                const { Success } = await Post(`/SportRecord/Delete`, { Id: Id });\n                if (Success) {\n                    await GetSportRecordListApi();\n                    uni.showToast({\n                        title: '删除成功',\n                        icon: 'success'\n                    });\n                }\n            }\n        }\n    })\n};\n\n</script>\n\n<style scoped lang=\"scss\">\n/* 内容区域样式 */\n.content {\n\n    padding-bottom: 120rpx;\n    /* 为浮动按钮留出空间 */\n    min-height: calc(100vh - 88rpx);\n    background-color: #f8f9fa;\n}\n\n/* 运动统计卡片样式 */\n.statistics-section {\n    background-color: #fff;\n    border-radius: 16rpx;\n    padding: 24rpx;\n    margin: 20rpx;\n    box-shadow: 0 2rpx 12rpx rgba(0, 0, 0, 0.06);\n}\n\n.statistics-title {\n    display: flex;\n    align-items: center;\n    margin-bottom: 20rpx;\n}\n\n.statistics-title uni-icons {\n    margin-right: 10rpx;\n}\n\n.statistics-title text {\n    font-size: 32rpx;\n    font-weight: 600;\n    color: #2c3e50;\n}\n\n.statistics-cards {\n    display: flex;\n    justify-content: space-around;\n    flex-wrap: wrap;\n    margin-bottom: 20rpx;\n}\n\n.stat-card {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    width: 30%;\n    /* 调整卡片宽度 */\n    margin-bottom: 20rpx;\n}\n\n.stat-value {\n    font-size: 36rpx;\n    font-weight: 700;\n    color: #e74c3c;\n    /* 红色 */\n    margin-bottom: 8rpx;\n}\n\n.stat-label {\n    font-size: 24rpx;\n    color: #7f8c8d;\n    margin-bottom: 8rpx;\n}\n\n.stat-unit {\n    font-size: 24rpx;\n    color: #7f8c8d;\n}\n\n/* 运动记录列表样式 */\n.record-list {\n    padding: 20rpx;\n}\n\n/* 单个记录项样式 */\n.record-item {\n    background-color: #fff;\n    border-radius: 16rpx;\n    margin-bottom: 20rpx;\n    padding: 24rpx;\n    box-shadow: 0 2rpx 12rpx rgba(0, 0, 0, 0.06);\n    transition: all 0.3s ease;\n}\n\n.record-item:active {\n    transform: scale(0.98);\n    box-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.1);\n}\n\n/* 记录头部样式 */\n.record-header {\n    display: flex;\n    align-items: center;\n    margin-bottom: 16rpx;\n}\n\n.sport-icon {\n    width: 60rpx;\n    height: 60rpx;\n    border-radius: 12rpx;\n    margin-right: 16rpx;\n}\n\n.sport-info {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n}\n\n.sport-name {\n    font-size: 32rpx;\n    font-weight: 600;\n    color: #2c3e50;\n    margin-bottom: 4rpx;\n}\n\n.record-time {\n    font-size: 24rpx;\n    color: #95a5a6;\n}\n\n.delete-btn {\n    padding: 8rpx;\n    border-radius: 8rpx;\n    background-color: #fee;\n    transition: all 0.3s ease;\n}\n\n.delete-btn:active {\n    background-color: #fdd;\n    transform: scale(0.95);\n}\n\n/* 运动数据样式 */\n.record-data {\n    display: flex;\n    justify-content: space-between;\n    margin-bottom: 16rpx;\n    padding: 16rpx;\n    background-color: #f8f9fa;\n    border-radius: 12rpx;\n}\n\n.data-item {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    flex: 1;\n}\n\n.data-label {\n    font-size: 24rpx;\n    color: #7f8c8d;\n    margin-bottom: 4rpx;\n}\n\n.data-value {\n    font-size: 28rpx;\n    font-weight: 600;\n    color: #2c3e50;\n}\n\n.data-value.calories {\n    color: #e74c3c;\n}\n\n/* 运动描述样式 */\n.sport-description {\n    padding: 12rpx 0;\n    border-top: 1rpx solid #ecf0f1;\n}\n\n.sport-description text {\n    font-size: 26rpx;\n    color: #7f8c8d;\n    line-height: 1.5;\n}\n\n/* 空状态样式 */\n.empty-state {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 120rpx 40rpx;\n    text-align: center;\n}\n\n.empty-text {\n    font-size: 32rpx;\n    color: #95a5a6;\n    margin: 24rpx 0 12rpx 0;\n    font-weight: 500;\n}\n\n.empty-tip {\n    font-size: 26rpx;\n    color: #bdc3c7;\n}\n\n/* 浮动添加按钮样式 */\n.floating-add-btn {\n    position: fixed;\n    bottom: 60rpx;\n    right: 60rpx;\n    width: 100rpx;\n    height: 100rpx;\n    background-color: var(--primary-color, #007aff);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    box-shadow: 0 4rpx 16rpx rgba(0, 122, 255, 0.3);\n    z-index: 999;\n    transition: all 0.3s ease;\n}\n\n/* 按钮悬停效果 */\n.floating-add-btn:active {\n    transform: scale(0.95);\n    box-shadow: 0 2rpx 8rpx rgba(0, 122, 255, 0.4);\n}\n</style>","import MiniProgramPage from 'F:/workspace/HealthControl.uniapp/pages/Front/SportRecordList.vue'\nwx.createPage(MiniProgramPage)"],"names":["useCommonStore","computed","ref","reactive","onLoad","onShow","onReady","uni","Post"],"mappings":"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"}