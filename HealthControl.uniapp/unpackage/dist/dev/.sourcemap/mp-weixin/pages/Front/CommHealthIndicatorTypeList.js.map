{"version":3,"file":"CommHealthIndicatorTypeList.js","sources":["pages/Front/CommHealthIndicatorTypeList.vue","../../HBuilderX/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvRnJvbnQvQ29tbUhlYWx0aEluZGljYXRvclR5cGVMaXN0LnZ1ZQ"],"sourcesContent":["<template>\r\n    <view>\r\n        <!-- 导航栏 -->\r\n        <uni-nav-bar dark :fixed=\"true\" shadow background-color=\"var(--primary-color)\" status-bar left-icon=\"left\"\r\n            left-text=\"返回\" @clickLeft=\"goBack\" title=\"官方健康指标\" />\r\n\r\n        <!-- 页面内容 -->\r\n        <view class=\"page-content\">\r\n            <!-- 页面描述 -->\r\n            <view class=\"page-description\">\r\n                <view class=\"description-text\">\r\n                    选择官方推荐的健康指标分类，科学管理您的健康数据\r\n                </view>\r\n            </view>\r\n\r\n            <!-- 官方指标分类列表 -->\r\n            <view class=\"category-list\" v-if=\"CommHealthIndicatorTypeList.length > 0\">\r\n                <view class=\"category-item\" v-for=\"(category, index) in CommHealthIndicatorTypeList\" :key=\"category.Id\">\r\n                    <!-- 分类头部 -->\r\n                    <view class=\"category-header\" @click=\"toggleCategory(index)\">\r\n                        <!-- 分类图标 -->\r\n                        <view class=\"category-icon\">\r\n                            <uni-icons type=\"heart\" size=\"22\" color=\"#4CAF50\"></uni-icons>\r\n                        </view>\r\n\r\n                        <!-- 分类信息 -->\r\n                        <view class=\"category-info\">\r\n                            <view class=\"category-name\">{{ category.Name }}</view>\r\n                            <view class=\"category-count\">{{ category.HealthIndicatorDtoList.length }}项指标</view>\r\n                        </view>\r\n\r\n                        <!-- 展开箭头 -->\r\n                        <view class=\"expand-arrow\" :class=\"{ 'expanded': expandedCategories.includes(index) }\">\r\n                            <uni-icons type=\"arrowdown\" size=\"16\" color=\"#666\"></uni-icons>\r\n                        </view>\r\n                    </view>\r\n\r\n                    <!-- 子指标列表 -->\r\n                    <view class=\"indicator-list\" v-show=\"expandedCategories.includes(index)\">\r\n                        <view class=\"indicator-item\" v-for=\"indicator in category.HealthIndicatorDtoList\"\r\n                            :key=\"indicator.Id\" @click=\"selectIndicator(indicator)\">\r\n                            <!-- 指标封面图片 -->\r\n                            <view class=\"indicator-cover\">\r\n                                <image v-if=\"indicator.Cover\" :src=\"indicator.Cover\" mode=\"aspectFill\"\r\n                                    class=\"cover-image\" />\r\n                                <view v-else class=\"cover-placeholder\">\r\n                                    <uni-icons type=\"image\" size=\"20\" color=\"#ccc\"></uni-icons>\r\n                                </view>\r\n                            </view>\r\n\r\n                            <!-- 指标内容 -->\r\n                            <view class=\"indicator-content\">\r\n                                <view class=\"indicator-name\">{{ indicator.Name }}</view>\r\n                                <view class=\"indicator-description\">{{ indicator.Content }}</view>\r\n                                <view class=\"indicator-threshold\">\r\n                                    <text class=\"threshold-label\">参考值：</text>\r\n                                    <text class=\"threshold-value\">{{ indicator.Threshold }}</text>\r\n                                </view>\r\n                            </view>\r\n\r\n                            <!-- 选择按钮 -->\r\n                            <view class=\"select-btn\" :class=\"{ 'selected': indicator.IsSelected }\">\r\n                                <uni-icons v-if=\"indicator.IsSelected\" type=\"checkmarkempty\" size=\"18\"\r\n                                    color=\"#ffffff\"></uni-icons>\r\n                                <uni-icons v-else type=\"plus\" size=\"18\" color=\"#4CAF50\"></uni-icons>\r\n                            </view>\r\n                        </view>\r\n                    </view>\r\n                </view>\r\n            </view>\r\n\r\n            <!-- 空状态 -->\r\n            <view class=\"empty-state\" v-else>\r\n                <view class=\"empty-icon\">\r\n                    <uni-icons type=\"info\" size=\"60\" color=\"#ccc\"></uni-icons>\r\n                </view>\r\n                <view class=\"empty-text\">暂无官方健康指标</view>\r\n                <view class=\"empty-description\">官方推荐的健康指标将在这里显示</view>\r\n            </view>\r\n        </view>\r\n    </view>\r\n</template>\r\n\r\n<script setup>\r\n\r\nimport { useCommonStore } from '@/store';\r\nimport { Post } from '@/utils/http';\r\nimport { onLoad, onReady, onShow } from \"@dcloudio/uni-app\";\r\nimport { computed, reactive, ref } from 'vue';\r\n\r\n// 获取store\r\nconst commonStore = useCommonStore();\r\nconst Token = computed(() => commonStore.Token)\r\nconst UserInfo = computed(() => commonStore.UserInfo)\r\nconst RoleType = computed(() => commonStore.RoleType)\r\nconst UserId = computed(() => commonStore.UserId)\r\n\r\nconst TestInfoList = ref([]);\r\n\r\nconst where = reactive({\r\n\r\n});\r\n\r\n// 展开的分类索引数组\r\nconst expandedCategories = ref([]);\r\n\r\n// 生命周期钩子\r\nonLoad(async (option) => {\r\n});\r\nonShow(async () => {\r\n    GetCommHealthIndicatorTypeListApi()\r\n});\r\n\r\nonReady(async () => {\r\n\r\n});\r\n\r\n// 方法\r\nconst goBack = () => {\r\n    uni.navigateBack();\r\n};\r\n\r\nconst CommHealthIndicatorTypeList = ref([]);\r\n//得到官方公开的指标分类\r\nconst GetCommHealthIndicatorTypeListApi = async () => {\r\n    let {\r\n        Data: {\r\n            Items\r\n        }\r\n    } = await Post('/HealthIndicatorType/CommUserHealthIndicatorList', {\r\n        IsComm: true\r\n    });\r\n    CommHealthIndicatorTypeList.value = Items;\r\n}\r\n\r\n// 切换分类展开状态\r\nconst toggleCategory = (index) => {\r\n    const expandIndex = expandedCategories.value.indexOf(index);\r\n    if (expandIndex > -1) {\r\n        // 如果已展开，则收起\r\n        expandedCategories.value.splice(expandIndex, 1);\r\n    } else {\r\n        // 如果未展开，则展开\r\n        expandedCategories.value.push(index);\r\n    }\r\n};\r\n\r\n// 选择具体指标\r\nconst selectIndicator = async (indicator) => {\r\n\r\n    if (indicator.IsSelected) {\r\n        let { Success } = await Post('/HealthIndicator/UserCancelCommIndicator', {\r\n            Name: indicator.Name,\r\n            BelongUserId: UserId.value,\r\n        });\r\n        if (Success) {\r\n            indicator.IsSelected = false;\r\n            uni.showToast({\r\n                title: `已取消选择：${indicator.Name}`,\r\n                icon: 'none'\r\n            });\r\n        }\r\n    }\r\n    else {\r\n\r\n        let { Success } = await Post('/HealthIndicator/UserAddCommIndicator', {\r\n            Name: indicator.Name,\r\n            Content: indicator.Content,\r\n            Threshold: indicator.Threshold,\r\n            HealthIndicatorTypeId: indicator.HealthIndicatorTypeId,\r\n            Cover: indicator.Cover,\r\n            BelongUserId: UserId.value,\r\n        });\r\n\r\n        if (Success) {\r\n            // 添加成功后，更新该指标的IsSelected状态\r\n            indicator.IsSelected = true;\r\n\r\n            uni.showToast({\r\n                title: `已选择：${indicator.Name}`,\r\n                icon: 'none'\r\n            });\r\n        }\r\n    }\r\n};\r\n\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n/* 页面内容区域 */\r\n.page-content {\r\n    min-height: 100vh;\r\n    background-color: #f5f5f5;\r\n    padding: 20rpx;\r\n}\r\n\r\n/* 页面描述区域 */\r\n.page-description {\r\n    background-color: #ffffff;\r\n    border-radius: 16rpx;\r\n    padding: 24rpx;\r\n    margin-bottom: 24rpx;\r\n    box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.06);\r\n}\r\n\r\n.description-text {\r\n    font-size: 28rpx;\r\n    color: #666666;\r\n    line-height: 1.6;\r\n    text-align: center;\r\n}\r\n\r\n/* 分类列表 */\r\n.category-list {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 16rpx;\r\n}\r\n\r\n/* 分类项 */\r\n.category-item {\r\n    background-color: #ffffff;\r\n    border-radius: 16rpx;\r\n    overflow: hidden;\r\n    box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.08);\r\n}\r\n\r\n/* 分类头部 */\r\n.category-header {\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 24rpx;\r\n    cursor: pointer;\r\n    transition: background-color 0.3s ease;\r\n\r\n    &:active {\r\n        background-color: #f8f8f8;\r\n    }\r\n}\r\n\r\n/* 分类图标 */\r\n.category-icon {\r\n    width: 52rpx;\r\n    height: 52rpx;\r\n    background: linear-gradient(135deg, #4CAF50, #45a049);\r\n    border-radius: 50%;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    margin-right: 16rpx;\r\n    box-shadow: 0 2rpx 6rpx rgba(76, 175, 80, 0.3);\r\n}\r\n\r\n/* 分类信息 */\r\n.category-info {\r\n    flex: 1;\r\n}\r\n\r\n.category-name {\r\n    font-size: 32rpx;\r\n    font-weight: 600;\r\n    color: #333333;\r\n    margin-bottom: 4rpx;\r\n}\r\n\r\n.category-count {\r\n    font-size: 24rpx;\r\n    color: #999999;\r\n}\r\n\r\n/* 展开箭头 */\r\n.expand-arrow {\r\n    transition: transform 0.3s ease;\r\n\r\n    &.expanded {\r\n        transform: rotate(180deg);\r\n    }\r\n}\r\n\r\n/* 指标列表 */\r\n.indicator-list {\r\n    border-top: 1rpx solid #f0f0f0;\r\n    background-color: #fafafa;\r\n}\r\n\r\n/* 指标项 */\r\n.indicator-item {\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 20rpx 24rpx;\r\n    border-bottom: 1rpx solid #f0f0f0;\r\n    transition: background-color 0.3s ease;\r\n\r\n    &:last-child {\r\n        border-bottom: none;\r\n    }\r\n\r\n    &:active {\r\n        background-color: #f0f0f0;\r\n    }\r\n}\r\n\r\n/* 指标封面 */\r\n.indicator-cover {\r\n    width: 64rpx;\r\n    height: 64rpx;\r\n    border-radius: 12rpx;\r\n    overflow: hidden;\r\n    margin-right: 16rpx;\r\n    background-color: #f5f5f5;\r\n}\r\n\r\n.cover-image {\r\n    width: 100%;\r\n    height: 100%;\r\n}\r\n\r\n.cover-placeholder {\r\n    width: 100%;\r\n    height: 100%;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background-color: #f0f0f0;\r\n}\r\n\r\n/* 指标内容 */\r\n.indicator-content {\r\n    flex: 1;\r\n    display: flex;\r\n    flex-direction: column;\r\n}\r\n\r\n.indicator-name {\r\n    font-size: 28rpx;\r\n    font-weight: 600;\r\n    color: #333333;\r\n    margin-bottom: 6rpx;\r\n}\r\n\r\n.indicator-description {\r\n    font-size: 24rpx;\r\n    color: #666666;\r\n    line-height: 1.4;\r\n    margin-bottom: 8rpx;\r\n}\r\n\r\n.indicator-threshold {\r\n    font-size: 22rpx;\r\n    display: flex;\r\n    align-items: center;\r\n}\r\n\r\n.threshold-label {\r\n    color: #999999;\r\n    margin-right: 4rpx;\r\n}\r\n\r\n.threshold-value {\r\n    color: #4CAF50;\r\n    font-weight: 600;\r\n}\r\n\r\n/* 选择按钮 */\r\n.select-btn {\r\n    width: 48rpx;\r\n    height: 48rpx;\r\n    border: 2rpx solid #4CAF50;\r\n    border-radius: 50%;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background-color: #ffffff;\r\n    transition: all 0.3s ease;\r\n\r\n    &:active {\r\n        background-color: #4CAF50;\r\n        transform: scale(0.9);\r\n    }\r\n\r\n    /* 已选择状态样式 */\r\n    &.selected {\r\n        background-color: #4CAF50;\r\n        border-color: #4CAF50;\r\n    }\r\n}\r\n\r\n/* 空状态 */\r\n.empty-state {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    padding: 80rpx 24rpx;\r\n    text-align: center;\r\n}\r\n\r\n.empty-icon {\r\n    margin-bottom: 24rpx;\r\n    opacity: 0.6;\r\n}\r\n\r\n.empty-text {\r\n    font-size: 32rpx;\r\n    font-weight: 600;\r\n    color: #999999;\r\n    margin-bottom: 12rpx;\r\n}\r\n\r\n.empty-description {\r\n    font-size: 26rpx;\r\n    color: #cccccc;\r\n    line-height: 1.5;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'F:/workspace/HealthControl.uniapp/pages/Front/CommHealthIndicatorTypeList.vue'\nwx.createPage(MiniProgramPage)"],"names":["useCommonStore","computed","ref","reactive","onLoad","onShow","onReady","uni","Post"],"mappings":";;;;;;;;;;;;;;;;;AA2FA,UAAM,cAAcA,YAAc,eAAA;AACpBC,kBAAAA,SAAS,MAAM,YAAY,KAAK;AAC7BA,kBAAAA,SAAS,MAAM,YAAY,QAAQ;AACnCA,kBAAAA,SAAS,MAAM,YAAY,QAAQ;AACpD,UAAM,SAASA,cAAQ,SAAC,MAAM,YAAY,MAAM;AAE3BC,kBAAG,IAAC,EAAE;AAEbC,kBAAAA,SAAS,CAEvB,CAAC;AAGD,UAAM,qBAAqBD,cAAAA,IAAI,CAAA,CAAE;AAGjCE,kBAAM,OAAC,OAAO,WAAW;AAAA,IACzB,CAAC;AACDC,kBAAAA,OAAO,YAAY;AACf,wCAAmC;AAAA,IACvC,CAAC;AAEDC,kBAAAA,QAAQ,YAAY;AAAA,IAEpB,CAAC;AAGD,UAAM,SAAS,MAAM;AACjBC,oBAAG,MAAC,aAAY;AAAA,IACpB;AAEA,UAAM,8BAA8BL,cAAAA,IAAI,CAAA,CAAE;AAE1C,UAAM,oCAAoC,YAAY;AAClD,UAAI;AAAA,QACA,MAAM;AAAA,UACF;AAAA,QACH;AAAA,MACT,IAAQ,MAAMM,WAAI,KAAC,oDAAoD;AAAA,QAC/D,QAAQ;AAAA,MAChB,CAAK;AACD,kCAA4B,QAAQ;AAAA,IACxC;AAGA,UAAM,iBAAiB,CAAC,UAAU;AAC9B,YAAM,cAAc,mBAAmB,MAAM,QAAQ,KAAK;AAC1D,UAAI,cAAc,IAAI;AAElB,2BAAmB,MAAM,OAAO,aAAa,CAAC;AAAA,MACtD,OAAW;AAEH,2BAAmB,MAAM,KAAK,KAAK;AAAA,MACtC;AAAA,IACL;AAGA,UAAM,kBAAkB,OAAO,cAAc;AAEzC,UAAI,UAAU,YAAY;AACtB,YAAI,EAAE,QAAO,IAAK,MAAMA,WAAAA,KAAK,4CAA4C;AAAA,UACrE,MAAM,UAAU;AAAA,UAChB,cAAc,OAAO;AAAA,QACjC,CAAS;AACD,YAAI,SAAS;AACT,oBAAU,aAAa;AACvBD,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO,SAAS,UAAU,IAAI;AAAA,YAC9B,MAAM;AAAA,UACtB,CAAa;AAAA,QACJ;AAAA,MACJ,OACI;AAED,YAAI,EAAE,QAAO,IAAK,MAAMC,WAAAA,KAAK,yCAAyC;AAAA,UAClE,MAAM,UAAU;AAAA,UAChB,SAAS,UAAU;AAAA,UACnB,WAAW,UAAU;AAAA,UACrB,uBAAuB,UAAU;AAAA,UACjC,OAAO,UAAU;AAAA,UACjB,cAAc,OAAO;AAAA,QACjC,CAAS;AAED,YAAI,SAAS;AAET,oBAAU,aAAa;AAEvBD,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO,OAAO,UAAU,IAAI;AAAA,YAC5B,MAAM;AAAA,UACtB,CAAa;AAAA,QACJ;AAAA,MACJ;AAAA,IACL;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvLA,GAAG,WAAW,eAAe;"}