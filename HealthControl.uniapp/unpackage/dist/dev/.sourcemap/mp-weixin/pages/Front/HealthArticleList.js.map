{"version":3,"file":"HealthArticleList.js","sources":["pages/Front/HealthArticleList.vue","../../HBuilderX/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvRnJvbnQvSGVhbHRoQXJ0aWNsZUxpc3QudnVl"],"sourcesContent":["<template>\n    <view class=\"health-article-container\">\n        <!-- 导航栏 -->\n        <uni-nav-bar dark :fixed=\"true\" shadow background-color=\"var(--primary-color)\" status-bar left-icon=\"left\"\n            left-text=\"返回\" @clickLeft=\"goBack\" title=\"健康知识列表\" />\n\n        <!-- 内容区域 -->\n        <view class=\"content-wrapper\">\n            <!-- 搜索栏 -->\n            <view class=\"search-section\">\n                <uni-search-bar v-model=\"searchKeyword\" placeholder=\"搜索健康知识...\" @input=\"onSearchInput\"\n                    @clear=\"onSearchClear\" cancelButton=\"none\" />\n            </view>\n\n            <!-- 分类筛选 -->\n            <view class=\"category-filter\">\n                <scroll-view scroll-x=\"true\" class=\"category-scroll\">\n                    <view class=\"category-list\">\n                        <view class=\"category-item\" :class=\"{ active: selectedCategoryId === 0 }\"\n                            @click=\"selectCategory(0)\">\n                            全部\n                        </view>\n                        <view v-for=\"category in HealthArticleTypeList\" :key=\"category.Id\" class=\"category-item\"\n                            :class=\"{ active: selectedCategoryId === category.Id }\" @click=\"selectCategory(category.Id)\">\n                            {{ category.Name }}\n                        </view>\n                    </view>\n                </scroll-view>\n            </view>\n\n            <!-- 文章列表 -->\n            <view class=\"article-list\">\n                <view v-for=\"article in filteredArticleList\" :key=\"article.Id\" class=\"article-card\"\n                    @click=\"goToArticleDetail(article.Id)\">\n                    <!-- 文章封面 -->\n                    <view class=\"article-cover\">\n                        <image :src=\"article.Cover\" mode=\"aspectFill\" class=\"cover-image\" />\n                        <!-- 审核状态标签 -->\n                        <view class=\"audit-status\" :class=\"{\n                            'status-approved': article.AuditStatus === 2,\n                            'status-pending': article.AuditStatus === 1\n                        }\">\n                            {{ article.AuditStatusFormat }}\n                        </view>\n                    </view>\n\n                    <!-- 文章信息 -->\n                    <view class=\"article-info\">\n                        <!-- 标题 -->\n                        <view class=\"article-title\">{{ article.Title }}</view>\n\n                        <!-- 分类和浏览量 -->\n                        <view class=\"article-meta\">\n                            <view class=\"category-tag\">\n                                {{ article.HealthArticleTypeDto.Name }}\n                            </view>\n                            <view class=\"view-count\">\n                                <uni-icons type=\"eye\" size=\"14\" color=\"#999\" />\n                                <text class=\"count-text\">{{ article.ViewCount }}</text>\n                            </view>\n                        </view>\n\n                        <!-- 发布信息 -->\n                        <view class=\"publish-info\">\n                            <view class=\"author\">{{ article.PublishUserDto.Name }}</view>\n                            <view class=\"publish-time\">{{ formatTime(article.CreationTime) }}</view>\n                        </view>\n                    </view>\n                </view>\n\n                <!-- 空状态 -->\n                <view v-if=\"filteredArticleList.length === 0\" class=\"empty-state\">\n                    <uni-icons type=\"info\" size=\"48\" color=\"#ccc\" />\n                    <text class=\"empty-text\">暂无相关健康知识</text>\n                </view>\n            </view>\n        </view>\n    </view>\n</template>\n\n<script setup>\nimport { useCommonStore } from '@/store';\nimport { Post } from '@/utils/http';\nimport { onLoad, onReady, onShow } from \"@dcloudio/uni-app\";\nimport { computed, reactive, ref } from 'vue';\n\n// 获取store\nconst commonStore = useCommonStore();\nconst Token = computed(() => commonStore.Token)\nconst UserInfo = computed(() => commonStore.UserInfo)\nconst RoleType = computed(() => commonStore.RoleType)\nconst UserId = computed(() => commonStore.UserId)\n\n// 数据定义\nconst HealthArticleList = ref([]); // 健康知识文章列表\nconst HealthArticleTypeList = ref([]); // 健康知识分类列表\nconst searchKeyword = ref(''); // 搜索关键词\nconst selectedCategoryId = ref(0); // 选中的分类ID，0表示全部\n\nconst where = reactive({\n    KeyWord: '',\n    HealthArticleTypeId: null,\n    AuditStatus: 2\n});\n\n// 计算属性 - 过滤后的文章列表（仅用于分类筛选）\nconst filteredArticleList = computed(() => {\n    let filtered = HealthArticleList.value;\n\n    // 按分类筛选\n    if (selectedCategoryId.value !== 0) {\n        filtered = filtered.filter(article =>\n            article.HealthArticleTypeId === selectedCategoryId.value\n        );\n    }\n\n    return filtered;\n});\n\n// 生命周期钩子\nonLoad(async (option) => {\n    await GetHealthArticleTypeListApi();\n    await GetHealthArticleListApi();\n});\n\nonShow(async () => {\n    // 页面显示时刷新数据\n});\n\nonReady(async () => {\n    // 页面准备完毕\n});\n\n// 方法定义\nconst goBack = () => {\n    uni.navigateBack();\n};\n\n// 获取健康知识分类列表\nconst GetHealthArticleTypeListApi = async () => {\n    try {\n        const { Success, Data: { Items } } = await Post('/HealthArticleType/List', {});\n        if (Success) {\n            // 按Sort字段升序排序\n            HealthArticleTypeList.value = Items.sort((a, b) => a.Sort - b.Sort);\n        }\n    } catch (error) {\n        console.error('获取健康知识类型列表失败:', error);\n    }\n};\n\n// 获取健康知识列表\nconst GetHealthArticleListApi = async () => {\n    try {\n        const response = await Post('/HealthArticle/List', where);\n        if (response.Success && response.Data && response.Data.Items) {\n            HealthArticleList.value = response.Data.Items;\n        }\n    } catch (error) {\n        console.error('获取健康知识列表失败:', error);\n        uni.showToast({\n            title: '获取数据失败',\n            icon: 'error'\n        });\n    }\n};\n\n\n\n// 搜索输入处理\nconst onSearchInput = (value) => {\n    searchKeyword.value = value;\n    // 实时搜索，更新where条件并重新获取数据\n    where.KeyWord = value.trim();\n    GetHealthArticleListApi();\n};\n\n// 清除搜索\nconst onSearchClear = () => {\n    searchKeyword.value = '';\n    where.KeyWord = '';\n    GetHealthArticleListApi();\n};\n\n// 选择分类\nconst selectCategory = (categoryId) => {\n    selectedCategoryId.value = categoryId;\n    // 更新where条件并重新获取数据\n    where.HealthArticleTypeId = categoryId === 0 ? null : categoryId;\n    GetHealthArticleListApi();\n};\n\n// 跳转到文章详情\nconst goToArticleDetail = (articleId) => {\n    uni.navigateTo({\n        url: `/pages/Front/HealthArticleDetail?HealthArticleId=${articleId}`\n    });\n};\n\n// 格式化时间\nconst formatTime = (timeString) => {\n    if (!timeString) return '';\n    const date = new Date(timeString);\n    const now = new Date();\n    const diff = now.getTime() - date.getTime();\n\n    // 计算时间差\n    const minutes = Math.floor(diff / (1000 * 60));\n    const hours = Math.floor(diff / (1000 * 60 * 60));\n    const days = Math.floor(diff / (1000 * 60 * 60 * 24));\n\n    if (minutes < 60) {\n        return `${minutes}分钟前`;\n    } else if (hours < 24) {\n        return `${hours}小时前`;\n    } else if (days < 7) {\n        return `${days}天前`;\n    } else {\n        return timeString.split(' ')[0]; // 显示日期部分\n    }\n};\n\n\n</script>\n\n<style scoped lang=\"scss\">\n.health-article-container {\n    min-height: 100vh;\n    background-color: #f5f5f5;\n}\n\n\n\n/* 搜索区域 */\n.search-section {\n    padding: 30upx;\n    background-color: #fff;\n    margin-bottom: 20upx;\n}\n\n/* 分类筛选区域 */\n.category-filter {\n    background-color: #fff;\n    padding: 30upx 0;\n    margin-bottom: 20upx;\n}\n\n.category-scroll {\n    white-space: nowrap;\n    /* 隐藏滚动条但保持滚动功能 */\n    overflow-x: auto;\n    scrollbar-width: none;\n    /* Firefox */\n    -ms-overflow-style: none;\n    /* Internet Explorer 10+ */\n\n    &::-webkit-scrollbar {\n        display: none;\n        /* WebKit */\n    }\n}\n\n.category-list {\n    display: flex;\n    padding: 0 30upx;\n}\n\n.category-item {\n    flex-shrink: 0;\n    padding: 16upx 32upx;\n    margin-right: 20upx;\n    background-color: #f8f8f8;\n    border-radius: 40upx;\n    font-size: 28upx;\n    color: #666;\n    transition: all 0.3s ease;\n\n    &.active {\n        background-color: var(--primary-color, #007aff);\n        color: #fff;\n    }\n\n    &:last-child {\n        margin-right: 30upx;\n    }\n}\n\n/* 文章列表区域 */\n.article-list {\n    padding: 0 30upx;\n}\n\n.article-card {\n    background-color: #fff;\n    border-radius: 24upx;\n    margin-bottom: 30upx;\n    overflow: hidden;\n    box-shadow: 0 4upx 16upx rgba(0, 0, 0, 0.1);\n    transition: transform 0.2s ease;\n\n    &:active {\n        transform: scale(0.98);\n    }\n}\n\n/* 文章封面 */\n.article-cover {\n    position: relative;\n    height: 360upx;\n    overflow: hidden;\n}\n\n.cover-image {\n    width: 100%;\n    height: 100%;\n}\n\n.audit-status {\n    position: absolute;\n    top: 20upx;\n    right: 20upx;\n    padding: 8upx 16upx;\n    border-radius: 24upx;\n    font-size: 24upx;\n    color: #fff;\n\n    &.status-approved {\n        background-color: #4cd964;\n    }\n\n    &.status-pending {\n        background-color: #ff9500;\n    }\n}\n\n/* 文章信息 */\n.article-info {\n    padding: 30upx;\n}\n\n.article-title {\n    font-size: 32upx;\n    font-weight: 600;\n    color: #333;\n    line-height: 1.4;\n    margin-bottom: 20upx;\n    display: -webkit-box;\n    -webkit-line-clamp: 2;\n    -webkit-box-orient: vertical;\n    overflow: hidden;\n}\n\n.article-meta {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 20upx;\n}\n\n.category-tag {\n    padding: 8upx 16upx;\n    background-color: #f0f0f0;\n    border-radius: 16upx;\n    font-size: 24upx;\n    color: #666;\n}\n\n.view-count {\n    display: flex;\n    align-items: center;\n\n    .count-text {\n        margin-left: 8upx;\n        font-size: 24upx;\n        color: #999;\n    }\n}\n\n.publish-info {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    font-size: 24upx;\n    color: #999;\n}\n\n.author {\n    font-weight: 500;\n}\n\n.publish-time {\n    color: #ccc;\n}\n\n/* 空状态 */\n.empty-state {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 120upx 40upx;\n\n    .empty-text {\n        margin-top: 30upx;\n        font-size: 28upx;\n        color: #999;\n    }\n}\n\n/* 响应式适配 */\n@media (max-width: 375px) {\n    .article-cover {\n        height: 320upx;\n    }\n\n    .article-title {\n        font-size: 30upx;\n    }\n}\n</style>","import MiniProgramPage from 'F:/workspace/HealthControl.uniapp/pages/Front/HealthArticleList.vue'\nwx.createPage(MiniProgramPage)"],"names":["useCommonStore","computed","ref","reactive","onLoad","onShow","onReady","uni","Post"],"mappings":"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"}