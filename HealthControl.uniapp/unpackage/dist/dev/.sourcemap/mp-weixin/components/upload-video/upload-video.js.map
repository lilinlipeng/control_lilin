{"version":3,"file":"upload-video.js","sources":["components/upload-video/upload-video.vue","../../HBuilderX/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/Rjovd29ya3NwYWNlL0hlYWx0aENvbnRyb2wudW5pYXBwL2NvbXBvbmVudHMvdXBsb2FkLXZpZGVvL3VwbG9hZC12aWRlby52dWU"],"sourcesContent":["<template>\n    <view>\n        <uni-file-picker :limit=\"limit\" v-model=\"fileLists\" :title=\"'最多选择' + limit + '个视频'\" @select=\"select\"\n            @progress=\"progress\" @success=\"success\" @fail=\"fail\" @delete='deleteFile' file-mediatype=\"video\"\n            :file-extname=\"fileExtname\"> </uni-file-picker>\n\n        <!-- 视频预览区域 -->\n        <view class=\"video-preview-container\" v-if=\"fileLists.length > 0\">\n            <view class=\"video-preview-item\" v-for=\"(item, index) in fileLists\" :key=\"index\">\n                <video :src=\"item.url\" class=\"preview-video\" controls></video>\n                <view class=\"video-name\">{{ item.name }}</view>\n            </view>\n        </view>\n    </view>\n</template>\n\n<script setup>\nimport { useCommonStore } from '@/store';\nimport { FullConvertUrlArray } from \"@/utils/comm\";\nimport { Upload } from \"@/utils/http\";\nimport { computed, ref, watch } from 'vue';\n\n// 获取store\nconst commonStore = useCommonStore();\n\nconst Token = computed(() => commonStore.Token)\nconst UserInfo = computed(() => commonStore.UserInfo)\nconst RoleType = computed(() => commonStore.RoleType)\nconst UserId = computed(() => commonStore.UserId)\n\n// 定义props\nconst props = defineProps({\n    modelValue: {\n        type: [Number, String],\n        default: ''\n    },\n    limit: {\n        type: Number,\n        default: 1\n    },\n    fileExtname: {\n        type: Array,\n        default: () => ['mp4', 'mov', 'avi', 'wmv', 'flv', 'mkv']\n    }\n});\n\n// 定义emit\nconst emit = defineEmits(['update:modelValue']);\n\n// 定义响应式数据\nconst fileLists = ref([]);\n\n// 监听value变化\nwatch(() => props.modelValue, (newVal) => {\n\n    if (newVal) {\n        fileLists.value = newVal.split(\",\").map(x => {\n            let fileInfo = FullConvertUrlArray(x);\n            return {\n                url: fileInfo[0].url,\n                extname: fileInfo[0].type,\n                name: fileInfo[0].name\n            };\n        });\n    } else {\n        fileLists.value = [];\n    }\n}, { immediate: true });\n\n// 获取上传状态\nconst select = async (e) => {\n    const { tempFilePaths, tempFiles } = e;\n    if (tempFilePaths && tempFilePaths.length > 0) {\n        for (let tempFilePath of tempFilePaths) {\n            let { Data } = await Upload(tempFilePath);\n            for (var item of Data) {\n                let fileInfo = FullConvertUrlArray(item.Url);\n                fileLists.value.push({\n                    url: fileInfo[0].url,\n                    extname: fileInfo[0].type,\n                    name: fileInfo[0].name\n                });\n            }\n        }\n        covertUrl();\n    }\n};\n\n// 获取上传进度\nconst progress = (e) => {\n\n};\n\n// 上传成功\nconst success = (e) => {\n\n    covertUrl();\n};\n\n// 上传失败\nconst fail = (e) => {\n\n};\n\n// 删除文件\nconst deleteFile = (e) => {\n    fileLists.value.splice(e.index, 1);\n    covertUrl();\n};\n\n// 转换URL并触发input事件\nconst covertUrl = () => {\n    let url = fileLists.value.length > 0 ? fileLists.value.map(x => x.url).join(\",\") : \"\";\n    emit('update:modelValue', url)\n};\n</script>\n\n<style lang=\"scss\" scoped>\n/* 视频预览容器 */\n.video-preview-container {\n    display: flex;\n    flex-direction: column;\n    margin-top: 15px;\n}\n\n/* 视频预览项 */\n.video-preview-item {\n    margin-bottom: 15px;\n    border-radius: 8px;\n    overflow: hidden;\n    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);\n}\n\n/* 预览视频 */\n.preview-video {\n    width: 100%;\n    height: 200px;\n}\n\n/* 视频名称 */\n.video-name {\n    font-size: 14px;\n    color: #333;\n    padding: 8px;\n    background-color: #f5f5f5;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n</style>\n","import Component from 'F:/workspace/HealthControl.uniapp/components/upload-video/upload-video.vue'\nwx.createComponent(Component)"],"names":["useCommonStore","computed","ref","watch","FullConvertUrlArray","Upload"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuBA,UAAM,cAAcA,YAAc,eAAA;AAEpBC,kBAAAA,SAAS,MAAM,YAAY,KAAK;AAC7BA,kBAAAA,SAAS,MAAM,YAAY,QAAQ;AACnCA,kBAAAA,SAAS,MAAM,YAAY,QAAQ;AACrCA,kBAAAA,SAAS,MAAM,YAAY,MAAM;AAGhD,UAAM,QAAQ;AAgBd,UAAM,OAAO;AAGb,UAAM,YAAYC,cAAAA,IAAI,CAAA,CAAE;AAGxBC,kBAAK,MAAC,MAAM,MAAM,YAAY,CAAC,WAAW;AAEtC,UAAI,QAAQ;AACR,kBAAU,QAAQ,OAAO,MAAM,GAAG,EAAE,IAAI,OAAK;AACzC,cAAI,WAAWC,+BAAoB,CAAC;AACpC,iBAAO;AAAA,YACH,KAAK,SAAS,CAAC,EAAE;AAAA,YACjB,SAAS,SAAS,CAAC,EAAE;AAAA,YACrB,MAAM,SAAS,CAAC,EAAE;AAAA,UAClC;AAAA,QACA,CAAS;AAAA,MACT,OAAW;AACH,kBAAU,QAAQ;MACrB;AAAA,IACL,GAAG,EAAE,WAAW,KAAI,CAAE;AAGtB,UAAM,SAAS,OAAO,MAAM;AACxB,YAAM,EAAE,eAAe,UAAW,IAAG;AACrC,UAAI,iBAAiB,cAAc,SAAS,GAAG;AAC3C,iBAAS,gBAAgB,eAAe;AACpC,cAAI,EAAE,KAAM,IAAG,MAAMC,WAAM,OAAC,YAAY;AACxC,mBAAS,QAAQ,MAAM;AACnB,gBAAI,WAAWD,WAAAA,oBAAoB,KAAK,GAAG;AAC3C,sBAAU,MAAM,KAAK;AAAA,cACjB,KAAK,SAAS,CAAC,EAAE;AAAA,cACjB,SAAS,SAAS,CAAC,EAAE;AAAA,cACrB,MAAM,SAAS,CAAC,EAAE;AAAA,YACtC,CAAiB;AAAA,UACJ;AAAA,QACJ;AACD;MACH;AAAA,IACL;AAGA,UAAM,WAAW,CAAC,MAAM;AAAA,IAExB;AAGA,UAAM,UAAU,CAAC,MAAM;AAEnB;IACJ;AAGA,UAAM,OAAO,CAAC,MAAM;AAAA,IAEpB;AAGA,UAAM,aAAa,CAAC,MAAM;AACtB,gBAAU,MAAM,OAAO,EAAE,OAAO,CAAC;AACjC;IACJ;AAGA,UAAM,YAAY,MAAM;AACpB,UAAI,MAAM,UAAU,MAAM,SAAS,IAAI,UAAU,MAAM,IAAI,OAAK,EAAE,GAAG,EAAE,KAAK,GAAG,IAAI;AACnF,WAAK,qBAAqB,GAAG;AAAA,IACjC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjHA,GAAG,gBAAgB,SAAS;"}