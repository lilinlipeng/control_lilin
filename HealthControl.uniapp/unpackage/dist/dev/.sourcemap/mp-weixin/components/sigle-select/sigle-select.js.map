{"version":3,"file":"sigle-select.js","sources":["components/sigle-select/sigle-select.vue","../../HBuilderX/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/Rjovd29ya3NwYWNlL0hlYWx0aENvbnRyb2wudW5pYXBwL2NvbXBvbmVudHMvc2lnbGUtc2VsZWN0L3NpZ2xlLXNlbGVjdC52dWU"],"sourcesContent":["<template>\r\n    <uni-data-select v-model=\"selectValue\" :localdata=\"dataList\" @change=\"PickerChange\" primaryColor=\"var(--primary-color)\"\r\n        :clear=\"true\" :disabled='disabled'></uni-data-select>\r\n</template>\r\n\r\n<script setup>\r\nimport { useCommonStore } from '@/store';\r\nimport { GetObjectValue } from \"@/utils/comm.js\";\r\nimport { Post } from \"@/utils/http\";\r\nimport { computed, onMounted, ref, watch } from 'vue';\r\n\r\n// 获取store\r\nconst store = useCommonStore();\r\n\r\n\r\nconst Token = computed(() => commonStore.Token)\r\nconst UserInfo = computed(() => commonStore.UserInfo)\r\nconst RoleType = computed(() => commonStore.RoleType)\r\nconst UserId = computed(() => commonStore.UserId)\r\n\r\n// 定义props\r\nconst props = defineProps({\r\n    modelValue: {\r\n        type: [Number, String],\r\n        default: ''\r\n    },\r\n    url: {\r\n        type: String, //默认的请求路径\r\n        default: \"\",\r\n    },\r\n    columnName: {\r\n        type: String, //需要绑定Name的值\r\n        default: \"\",\r\n    },\r\n    columnValue: {\r\n        type: String, //需要绑定Value的值\r\n        default: \"\",\r\n    },\r\n    columnLabel: {\r\n        type: String, //需要绑定Label的值\r\n        default: \"\",\r\n    },\r\n    where: {\r\n        type: Object,\r\n        default: () => ({})\r\n    },\r\n    filterValue: {\r\n        type: Array, //需要绑定Value的值\r\n        default: () => []\r\n    },\r\n    disabled: {\r\n        type: Boolean,\r\n        default: false\r\n    },\r\n});\r\n\r\n// 定义emit\r\nconst emit = defineEmits(['update:modelValue', 'SelectCallBack']);\r\n\r\n// 定义响应式数据\r\nconst dataList = ref([]);\r\nconst where_ = ref({});\r\nconst searchWhere = ref({});\r\nconst selectValue = ref();\r\n\r\n// 监听modelValue变化\r\nwatch(() => props.modelValue, (newVal) => {\r\n    if (newVal != null && newVal !== undefined) {\r\n        selectValue.value = newVal.toString();\r\n    }\r\n}, { immediate: true });\r\n\r\n// 初始化\r\nonMounted(() => {\r\n    where_.value = props.where;\r\n    listApi();\r\n});\r\n\r\n// 重新加载数据\r\nconst reload = async (where) => {\r\n    let newSearchWhere = {};\r\n    if (where) {\r\n        newSearchWhere = Object.assign(newSearchWhere, where);\r\n    }\r\n    searchWhere.value = newSearchWhere;\r\n    await listApi(newSearchWhere);\r\n};\r\n\r\n// 获取数据列表\r\nconst listApi = async (customSearchWhere = {}) => {\r\n    try {\r\n        const { Data } = await Post(props.url, {\r\n            Limit: 999,\r\n            ...where_.value,\r\n            ...customSearchWhere\r\n        });\r\n\r\n        const items = Data.Items;\r\n        const newDataList = [];\r\n\r\n        items.forEach((item) => {\r\n            if (!props.filterValue.find(x => x == GetObjectValue(item, props.columnValue)?.toString())) {\r\n                newDataList.push({\r\n                    text: GetObjectValue(item, props.columnName),\r\n                    value: GetObjectValue(item, props.columnValue).toString(),\r\n                });\r\n            }\r\n        });\r\n\r\n        if (props.filterValue.filter(x => x.toString() == selectValue.value).length > 0) {\r\n            selectValue.value = undefined;\r\n        }\r\n\r\n        dataList.value = newDataList;\r\n    } catch (error) {\r\n\r\n    }\r\n};\r\n\r\n// 选择变更处理\r\nconst PickerChange = () => {\r\n    emit('update:modelValue', selectValue.value);\r\n    emit('SelectCallBack', selectValue.value);\r\n};\r\n\r\n// 对外暴露方法\r\ndefineExpose({\r\n    reload\r\n});\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.text {\r\n    font-size: 12px;\r\n    color: #666;\r\n    margin-top: 5px;\r\n}\r\n\r\n.uni-px-5 {\r\n    padding-left: 10px;\r\n    padding-right: 10px;\r\n}\r\n\r\n.uni-pb-5 {\r\n    padding-bottom: 10px;\r\n}\r\n\r\n.uni-select__input-text {\r\n    color: black;\r\n}\r\n</style>","import Component from 'F:/workspace/HealthControl.uniapp/components/sigle-select/sigle-select.vue'\nwx.createComponent(Component)"],"names":["useCommonStore","computed","ref","watch","onMounted","Post","GetObjectValue"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAYcA,gBAAAA,eAAiB;AAGjBC,kBAAAA,SAAS,MAAM,YAAY,KAAK;AAC7BA,kBAAAA,SAAS,MAAM,YAAY,QAAQ;AACnCA,kBAAAA,SAAS,MAAM,YAAY,QAAQ;AACrCA,kBAAAA,SAAS,MAAM,YAAY,MAAM;AAGhD,UAAM,QAAQ;AAoCd,UAAM,OAAO;AAGb,UAAM,WAAWC,cAAAA,IAAI,CAAA,CAAE;AACvB,UAAM,SAASA,cAAAA,IAAI,CAAA,CAAE;AACrB,UAAM,cAAcA,cAAAA,IAAI,CAAA,CAAE;AAC1B,UAAM,cAAcA,cAAG,IAAA;AAGvBC,kBAAK,MAAC,MAAM,MAAM,YAAY,CAAC,WAAW;AACtC,UAAI,UAAU,QAAQ,WAAW,QAAW;AACxC,oBAAY,QAAQ,OAAO;MAC9B;AAAA,IACL,GAAG,EAAE,WAAW,KAAI,CAAE;AAGtBC,kBAAAA,UAAU,MAAM;AACZ,aAAO,QAAQ,MAAM;AACrB;IACJ,CAAC;AAGD,UAAM,SAAS,OAAO,UAAU;AAC5B,UAAI,iBAAiB,CAAA;AACrB,UAAI,OAAO;AACP,yBAAiB,OAAO,OAAO,gBAAgB,KAAK;AAAA,MACvD;AACD,kBAAY,QAAQ;AACpB,YAAM,QAAQ,cAAc;AAAA,IAChC;AAGA,UAAM,UAAU,OAAO,oBAAoB,OAAO;AAC9C,UAAI;AACA,cAAM,EAAE,KAAM,IAAG,MAAMC,WAAAA,KAAK,MAAM,KAAK;AAAA,UACnC,OAAO;AAAA,UACP,GAAG,OAAO;AAAA,UACV,GAAG;AAAA,QACf,CAAS;AAED,cAAM,QAAQ,KAAK;AACnB,cAAM,cAAc,CAAA;AAEpB,cAAM,QAAQ,CAAC,SAAS;AACpB,cAAI,CAAC,MAAM,YAAY,KAAK,OAAC;;AAAI,0BAAKC,+BAAe,MAAM,MAAM,WAAW,MAAtCA,mBAAyC;AAAA,WAAU,GAAG;AACxF,wBAAY,KAAK;AAAA,cACb,MAAMA,WAAc,eAAC,MAAM,MAAM,UAAU;AAAA,cAC3C,OAAOA,WAAc,eAAC,MAAM,MAAM,WAAW,EAAE,SAAU;AAAA,YAC7E,CAAiB;AAAA,UACJ;AAAA,QACb,CAAS;AAED,YAAI,MAAM,YAAY,OAAO,OAAK,EAAE,SAAU,KAAI,YAAY,KAAK,EAAE,SAAS,GAAG;AAC7E,sBAAY,QAAQ;AAAA,QACvB;AAED,iBAAS,QAAQ;AAAA,MACpB,SAAQ,OAAO;AAAA,MAEf;AAAA,IACL;AAGA,UAAM,eAAe,MAAM;AACvB,WAAK,qBAAqB,YAAY,KAAK;AAC3C,WAAK,kBAAkB,YAAY,KAAK;AAAA,IAC5C;AAGA,aAAa;AAAA,MACT;AAAA,IACJ,CAAC;;;;;;;;;;;;;;;;;AC/HD,GAAG,gBAAgB,SAAS;"}